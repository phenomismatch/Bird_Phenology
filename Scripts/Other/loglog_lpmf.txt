#modified from brms stan call for cumulative(link = 'cloglog')
#function def from: https://www.statisticssolutions.com/ordinal-regression-2/
#NEED TO DEFINE INVERSE LOGLOG
#NEED TO MAKE SURE LINE 28+ ARE CORRECT FOR LOGLOG

functions { 

  /* compute the loglog link 
   * Args: 
   *   p: a scalar in (0, 1)
   * Returns: 
   *   a scalar in (-Inf, Inf)
   */ 
   real loglog(real p) { 
     return -log(-log(p)); 
   }


  /* cumulative-loglog log-PDF for a single response
   * Args:
   *   y: response category
   *   mu: linear predictor
   *   thres: ordinal thresholds
   *   disc: discrimination parameter - fixed to be 1
   * Returns:
   *   a scalar to be added to the log posterior
   */
   real cumulative_loglog_lpmf(int y, real mu, vector thres) {
     int ncat = num_elements(thres) + 1;
     real p;
     if (y == 1) 
     {
       p = inv_loglog(1 * (thres[1] - mu));
     } else if (y == ncat) {
       p = 1 - inv_loglog(1 * (thres[ncat - 1] - mu));
     } else {
       p = inv_loglog(1 * (thres[y] - mu)) -
           inv_loglog(1 * (thres[y - 1] - mu));
     }
     return log(p);
   } 
   
   
   for (n in 1:N)
   {
     y[i] ~ cumulative_cloglog_lpmf(mu[i], cuts);
   }